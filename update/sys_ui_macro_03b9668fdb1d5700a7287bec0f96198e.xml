<?xml version="1.0" encoding="UTF-8"?>
<record_update table="sys_ui_macro">
    <sys_ui_macro action="INSERT_OR_UPDATE">
        <active>true</active>
        <category>general</category>
        <description/>
        <media_type/>
        <name>provision_applications</name>
        <scoped_name>x_wcs_ctrx_auto_sv_provision_applications</scoped_name>
        <sys_class_name>sys_ui_macro</sys_class_name>
        <sys_created_by>sebastiang</sys_created_by>
        <sys_created_on>2018-04-10 21:47:07</sys_created_on>
        <sys_customer_update>false</sys_customer_update>
        <sys_id>03b9668fdb1d5700a7287bec0f96198e</sys_id>
        <sys_mod_count>46</sys_mod_count>
        <sys_name>provision_applications</sys_name>
        <sys_package display_value="Citrix Automation Services" source="x_wcs_ctrx_auto_sv">790cd3e8db8513406d3c72fc0f961915</sys_package>
        <sys_policy/>
        <sys_replace_on_upgrade>false</sys_replace_on_upgrade>
        <sys_scope display_value="Citrix Automation Services">790cd3e8db8513406d3c72fc0f961915</sys_scope>
        <sys_update_name>sys_ui_macro_03b9668fdb1d5700a7287bec0f96198e</sys_update_name>
        <sys_updated_by>sebastiang</sys_updated_by>
        <sys_updated_on>2018-04-11 18:50:32</sys_updated_on>
        <xml><![CDATA[<?xml version="1.0" encoding="utf-8" ?>
<j:jelly trim="false" xmlns:j="jelly:core" xmlns:g="glide" xmlns:j2="null" xmlns:g2="null">
	<head>
		<style>
			.modal-btn{
				min-width:60px;
			}
			.app-table{
				border:solid #E6E6E6 1px;
			}
		</style>
		
	</head>
	<body>
		<script>
			
			function selectAll(){
				
				var select_all = jQuery("#select_all");
				var value = select_all.prop("checked");
				
				jQuery('.checkbox').each(function(){
					if(!jQuery(this).hasClass('select-all')){
						jQuery(this).prop('checked',!value);
					}	  
				});
				updateApplicationValue();
			}
			
			function updateApplicationValue(checked,input_id){
				var name;
				var chosen_apps = [];
				if(checked != null $[AND] checked){
					name = input_id.replace(/_/g," ");
					chosen_apps.push(name);
				}
				jQuery('.checkbox').each(function(){
					if(!jQuery(this).hasClass('select-all')){
						if(jQuery(this).prop('checked') $[AND] this.id != input_id){		
							name = this.id;
							name = name.replace(/_/g," ");
							chosen_apps.push(name);
						}
					}	  
				});
			
				g_form.setValue('chosen_apps',JSON.stringify(chosen_apps));
			}
			
			function selectApp(input_id){
		
				var input = jQuery("#"+input_id);
				var checked = !input.prop("checked");  
				
				if(!checked $[AND] jQuery("#select_all").prop("checked")){
					jQuery("#select_all").prop("checked",false);
				}
			
				 updateApplicationValue(checked,input_id);
				
			}
			
			
		</script>
		<g:evaluate>
			var appProvision = new CTXAppProvision();
			var apps = appProvision.getApplications();
		
		</g:evaluate>
		<div class="col-sm-12">
			<table class="table table-hover original-table list-grid table-striped app-table" style="cursor: default; user-select: text;">
				<thead class="table-body-headers">
					<tr class="table-header">
						<th>
							<span class="input-group-checkbox">
								<input id="select_all" name="select_all" type="checkbox" class="checkbox select-all" />
								<label for="select_all" class="checkbox-label select-all" onclick="selectAll()"></label>
							</span>
						</th>

						<th class="table-column-header">

							<a class="sort-columns">Applications</a>
						</th>					
					</tr>
				</thead>
				<tbody class="list_table_tbody">

					<j:forEach items="$[apps]" var="jvar_app">

						<g:evaluate jelly="true">
							var name = jelly.jvar_app.Name;
							var no_space_name = name.replace(/ /g,"_");
						</g:evaluate>
						<tr class="data_row">
							<td class="col-small col-center decoration_cell col-control">
								<span class="input-group-checkbox">							
									<input id="${no_space_name}" name="${no_space_name}" type="checkbox" class="checkbox"/>
									<label for="${no_space_name}" class="checkbox-label" onclick="selectApp('${no_space_name}')"></label>
								</span>
							</td>

							<td class="vt grid-field">
								<span>${name}</span>
							</td>

						</tr>	
					</j:forEach>				
				</tbody>
			</table>
		
		</div>
	</body>
</j:jelly>
]]></xml>
    </sys_ui_macro>
</record_update>
